---
- name: "Local machine bootstrap"
  gather_facts: true
  tags: ["required_for_boot"]
  hosts:
    - archlinux.local
    - ubuntu.local
    - rpi5.local
  roles:
    - role: "hostname"
    - role: "network"
    - role: "user"
    - role: "ssh"
    - role: "password_policy"
  pre_tasks:
    - name: "Update package cache"
      become: true
      ansible.builtin.package:
        update_cache: true
      async: 60
      poll: 5
      failed_when: false
